var __decorate=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i},DIALOG;!(function(e){var t=(function(t){function n(o,r,s,a,l,c,u,h){void 0===s&&(s=null),void 0===c&&(c=i.LAYOUT_HORIZONTAL);var d=t.call(this,o,r,s,a,l)||this;if(d._layoutDir=c,d._button=u,d._topLevel=h,d.horizontalMargin=.1,d.verticalMargin=.1,d.horizontalAlignment=i.ALIGN_LEFT,d.verticalAlignment=i.ALIGN_TOP,d.borderInsideVert=.05,d.borderDepth=e.DialogSys.DEPTH_SCALING_3D,d.stretchHorizontal=!1,d.stretchVertical=!1,d._bold=!1,d.maxViewportWidth=1,d.maxViewportHeight=1,d._fitToWindow=!1,d._maxAboveOrigin=BABYLON.Vector3.Zero(),d._minBelowOrigin=BABYLON.Vector3.Zero(),d._nStretchers=[0,0],d._xyScale=1,d._dirty=!0,d._visibleBorder=!1,d._panelEnabled=!0,d._selected=!1,d._subs=new Array,!i.BORDER_MAT){i.BORDER_MAT=e.DialogSys.GOLD[1];var _=new BABYLON.MultiMaterial("Top Level mat",e.DialogSys._scene);_.subMaterials.push(e.DialogSys.GOLD[1]);var p=e.DialogSys.BLACK[0].clone("transBlack");p.alpha=.3,_.subMaterials.push(p),i.TOP_LEVEL_BORDER_MAT=_}if(d.useGeometryForBorder()){var g=d._topLevel||d._button;d.setVerticesData(BABYLON.VertexBuffer.PositionKind,d._computePositionsData(1,1),!0),d.setVerticesData(BABYLON.VertexBuffer.NormalKind,g?n._TOP_LEVEL_NORMALS:n._NORMALS,!1),d.setIndices(g?n._TOP_LEVEL_INDICES:n._INDICES),d.subMeshes=[],new BABYLON.SubMesh(0,0,40,0,168,d),g?(new BABYLON.SubMesh(1,40,4,168,6,d),d.material=i.TOP_LEVEL_BORDER_MAT):d.material=i.BORDER_MAT,d.setBorderVisible(d._topLevel)}return d._topLevel&&t.prototype.registerBeforeRender.call(d,n._beforeRender),d.placeHolderWidth=d.getFullScalePlaceholderWidth(),d.placeHolderHeight=d.getFullScalePlaceholderHeight(),d.isPickable=d._button,d}return __extends(n,t),n.prototype._computePositionsData=function(e,t){var i=this.borderInsideVert,n=e/2,o=-n,r=n-i,s=o+i,a=t/2,l=-a,c=a-i,u=l+i,h=this.borderDepth,d=[r,c,0,r,u,0,n,u,0,n,c,h,n,c,0,r,c,h,n,u,h,o,c,0,o,c,h,o,u,h,s,u,h,s,c,0,o,u,0,s,l,0,s,u,0,s,a,h,s,c,h,o,c,0,o,a,0,o,a,h,n,c,h,n,a,h,n,a,0,o,u,h,o,l,h,o,l,0,s,l,h,n,u,0,n,l,0,n,l,h,s,a,0,r,a,0,r,u,h,r,l,0,o,u,0,r,a,h,o,c,h,n,c,0,r,l,h,n,u,h];if(this._topLevel||this._button){this._button&&(h*=.1);var _=[r,u,h,r,c,h,s,c,h,s,u,h];d.push.apply(d,_)}return d},n._beforeRender=function(t){var i=t;i._dirty&&(i.layout(),e.DialogSys._adjustCameraForPanel())},n.prototype.setBorderVisible=function(e){this._visibleBorder=e,this.useGeometryForBorder&&(this.visibility=e?1:0)},n.prototype.isBorderVisible=function(){return this._visibleBorder},n.prototype.registerPickAction=function(t){this._pickFunc=t,this.actionManager=new BABYLON.ActionManager(e.DialogSys._scene);var i=this;this.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,function(){i._pickFunc()}))},n.prototype.assignCallback=function(e){this._callback=e},n.prototype.isSelected=function(){return this._selected},n.prototype.isPanelEnabled=function(){return this._panelEnabled},n.prototype.isButton=function(){return this._button},n.prototype.setButton=function(e){this.isPickable=this._button=e},Object.defineProperty(n.prototype,"fitToWindow",{get:function(){return this._fitToWindow},set:function(t){this._topLevel&&(this._fitToWindow=t,this._originalReqdWidth||(this._originalReqdWidth=this.getReqdWidth(),this._originalReqdHeight=this.getReqdHeight()),t||this.layout(),e.DialogSys._adjustCameraForPanel())},enumerable:!0,configurable:!0}),n.prototype.invalidateLayout=function(){this._dirty=!0;var e=this.parent;e&&"function"==typeof e.invalidateLayout&&e.invalidateLayout()},n.prototype.layout=function(){this._calcRequiredSize(),this._layout(this.getReqdWidth(),this.getReqdHeight()),this.freezeWorldMatrixTree(),this._dirty=!1},n.prototype._layout=function(e,t){this._validateAlignmnent(this._layoutDir===i.LAYOUT_HORIZONTAL)&&(e=this.stretchHorizontal?e:this.getReqdWidth(),t=this.stretchVertical?t:this.getReqdHeight(),this.useGeometryForBorder()&&this.updateVerticesData(BABYLON.VertexBuffer.PositionKind,this._computePositionsData(e,t),!0),this._layoutDir===i.LAYOUT_HORIZONTAL?this._horizontalLayout(e,t):this._verticalLayout(e,t),this._actualAboveOriginX=e/2,this._actualAboveOriginY=t/2,this._actualBelowOriginX=-e/2,this._actualBelowOriginY=-t/2,this._adjustLayoutForOrigin())},n.prototype._horizontalLayout=function(e,t){for(var n,o,r=this._nStretchers[0]>0?(e-this.getReqdWidth())/this._nStretchers[0]:0,s=t-2*this.verticalMargin,a=0;a<this._subs.length;a++)n=this._subs[a],n&&null!==n&&(o=n.getReqdWidth()+(n.stretchHorizontal?r:0),n._layout(o,s),n.verticalAlignment===i.ALIGN_BOTTOM?n.position.y=this.verticalMargin-n._actualBelowOriginY:n.verticalAlignment===i.ALIGN_VCENTER?n.position.y=(t-n.getReqdHeight())/2-n._actualBelowOriginY:n.position.y=t-(this.verticalMargin+n._actualAboveOriginY));for(var l=this.horizontalMargin,a=0;a<this._subs.length;a++)if(n=this._subs[a],n&&null!==n){if(n.horizontalAlignment===i.ALIGN_RIGHT)break;if(o=n.getReqdWidth()+(n.stretchHorizontal?r:0),n.horizontalAlignment!==i.ALIGN_LEFT){n.position.x=(e-o)/2-n._actualBelowOriginX;break}n.position.x=l-n._actualBelowOriginX,l+=o}else l+=this.placeHolderWidth;for(var c=e-this.horizontalMargin,a=this._subs.length-1;a>=0;a--)if(n=this._subs[a],n&&null!==n){if(n.horizontalAlignment!==i.ALIGN_RIGHT)break;o=n.getReqdWidth()+(n.stretchHorizontal?r:0),n.position.x=c-n._actualAboveOriginX,c-=o}else c-=this.placeHolderWidth},n.prototype._verticalLayout=function(e,t){for(var n,o,r=this._nStretchers[1]>0?(t-this.getReqdHeight())/this._nStretchers[1]:0,s=e-2*this.horizontalMargin,a=0;a<this._subs.length;a++)n=this._subs[a],n&&null!==n&&(o=n.getReqdHeight()+(n.stretchVertical?r:0),n._layout(s,o),n.stretchHorizontal?n.position.x=this.horizontalMargin-n._actualBelowOriginX:n.horizontalAlignment===i.ALIGN_LEFT?n.position.x=this.horizontalMargin-n._actualBelowOriginX:n.horizontalAlignment===i.ALIGN_HCENTER?n.position.x=(e-n.getReqdWidth())/2-n._actualBelowOriginX:n.position.x=e-(this.horizontalMargin+n._actualAboveOriginX));for(var l=t-this.verticalMargin,a=0;a<this._subs.length;a++)if(n=this._subs[a],n&&null!==n){if(n.verticalAlignment===i.ALIGN_BOTTOM)break;if(o=n.getReqdHeight()+(n.stretchVertical?r:0),n.verticalAlignment!==i.ALIGN_TOP){n.position.y=(t-o)/2-n._actualBelowOriginY;break}n.position.y=l-n._actualAboveOriginY,l-=o}else l-=this.placeHolderHeight;for(var c=this.verticalMargin,a=this._subs.length-1;a>=0;a--)if(n=this._subs[a],n&&null!==n){if(n.verticalAlignment!==i.ALIGN_BOTTOM)break;o=n.getReqdHeight()+(n.stretchVertical?r:0),n.position.y=c-n._actualBelowOriginY,c+=o}else c+=this.placeHolderHeight},n.prototype._adjustLayoutForOrigin=function(){for(var e,t=0;t<this._subs.length;t++)e=this._subs[t],e&&null!==e&&(e.position.x+=this._actualBelowOriginX,e.position.y+=this._actualBelowOriginY)},n.prototype._validateAlignmnent=function(e){for(var t,n,o,r=e?i.ALIGN_HCENTER:i.ALIGN_VCENTER,s=this._nStretchers[e?0:1]>0,a=0,l=-4,c=0;c<this._subs.length;c++)if(this._subs[c]&&null!==this._subs[c]){if(this._subs[c]._topLevel)return BABYLON.Tools.Error("Cannot embed top level panel in others.  Found in: "+this.name),!1;if(n=this._subs[c].horizontalAlignment,n<i.ALIGN_LEFT||n>i.ALIGN_RIGHT)return BABYLON.Tools.Error("Horizontal Layout value invalid for "+this._subs[c].name),!1;if(o=this._subs[c].verticalAlignment,o<i.ALIGN_TOP||o>i.ALIGN_BOTTOM)return BABYLON.Tools.Error("Vertical Layout value invalid for "+this._subs[c].name),!1;var t=e?n:o;if(!(l<=t))return BABYLON.Tools.Error("Must be in "+(e?"Lefts, up to 1 center, rights":"tops, up to 1 center, bottoms")+" order for: "+this.name),!1;if(l=t,t===r){if(s)return BABYLON.Tools.Error("Stretch & center alignments not compatible.  found amoung sub-panels of: "+this.name),!1;a++}}return!(a>1)||(BABYLON.Tools.Error("Multiple center alignments not valid for: "+this.name),!1)},n.prototype._calcRequiredSize=function(){var e,t,n,o,r,s=[0,0,0],a=[0,0,0],l=0,c=0,u=0;this._nStretchers[0]=0,this._nStretchers[1]=0;for(var h,d=0;d<this._subs.length;d++)h=this._subs[d],h&&null!==h?(h.stretchHorizontal&&this._nStretchers[0]++,h.stretchVertical&&this._nStretchers[1]++,h._calcRequiredSize(),e=h.getReqdWidth(),t=h.getReqdHeight(),n=h.getReqdDepth(),h.horizontalAlignment===i.ALIGN_LEFT&&(o=0),h.horizontalAlignment===i.ALIGN_HCENTER&&(o=1),h.horizontalAlignment===i.ALIGN_RIGHT&&(o=2),h.verticalAlignment===i.ALIGN_TOP&&(r=0),h.verticalAlignment===i.ALIGN_HCENTER&&(r=1),h.verticalAlignment===i.ALIGN_BOTTOM&&(r=2),l<n&&(l=n),this._layoutDir===i.LAYOUT_HORIZONTAL?(u<t&&(u=t),s[o]+=e):(c<e&&(c=e),a[r]+=t)):this._layoutDir===i.LAYOUT_HORIZONTAL?s[o]+=this.placeHolderWidth:a[r]+=this.placeHolderHeight;this._layoutDir===i.LAYOUT_HORIZONTAL?(c=s[1],s[1]>0&&(s[0]<s[2]?s[0]=s[2]:s[2]=s[0]),c+=s[0]+s[2]):(u=a[1],a[1]>0&&(a[0]<a[2]?a[0]=a[2]:a[2]=a[0]),u+=a[0]+a[2]),this._maxAboveOrigin.z=l/2,this._minBelowOrigin.z=-this._maxAboveOrigin.z,this._assignRequirements(c,u,l)},n.prototype.getReqdWidth=function(){return this._maxAboveOrigin.x-(this._minBelowOrigin.x<0?this._minBelowOrigin.x:0)},n.prototype.getReqdHeight=function(){return this._maxAboveOrigin.y-(this._minBelowOrigin.y<0?this._minBelowOrigin.y:0)},n.prototype._assignRequirements=function(e,t,i){this._maxAboveOrigin.x=this.horizontalMargin+e/2,this._minBelowOrigin.x=-this._maxAboveOrigin.x,this._maxAboveOrigin.y=this.verticalMargin+t/2,this._minBelowOrigin.y=-this._maxAboveOrigin.y,(!i||i<this.borderDepth)&&(i=this.borderDepth),this._maxAboveOrigin.z=i/2,this._minBelowOrigin.z=-this._maxAboveOrigin.z},n.prototype.getReqdDepth=function(){return this._maxAboveOrigin.z-(this._minBelowOrigin.z<0?this._minBelowOrigin.z:0)},n.prototype.setLayerMask=function(t){for(var i=this._subs.length-1;i>=0;i--)null!==this._subs[i]&&(this._subs[i].setLayerMask(t),this._subs[i].setEnabled(t!==e.DialogSys.SUSPENDED_DIALOG_LAYER));this.layerMask=t,this.setEnabled(t!==e.DialogSys.SUSPENDED_DIALOG_LAYER)},n.prototype.getSubPanels=function(){return this._subs},n.prototype.addSubPanel=function(e,t){void 0!==t?this._subs.splice(t,0,e):this._subs.push(e),e&&null!==e&&(e.parent=this,this.setLayerMask(this.layerMask)),this.invalidateLayout()},n.prototype.removeAt=function(e,t){!t&&this._subs[e]&&this._subs[e]&&this._subs[e].dispose(),this._subs.splice(e,1),this.invalidateLayout()},n.prototype.removeAll=function(e){if(!e)for(var t=this._subs.length-1;t>=0;t--)this._subs[t]&&this._subs[t]&&this._subs[t].dispose();this._subs=new Array,this.invalidateLayout()},n.prototype.getRootPanel=function(){var e=this.parent;return e?e.getRootPanel():this},n.prototype.useGeometryForBorder=function(){return!0},n.prototype.getFullScalePlaceholderWidth=function(){return.3},n.prototype.getFullScalePlaceholderHeight=function(){return.2},n.prototype.setUniformZ=function(e){for(var t,i=this._subs.length-1;i>=0;i--)t=this._subs[i],t&&null!==t&&(t.position.z=e+this._minBelowOrigin.z);this.invalidateLayout()},n.prototype.setSubsFaceSize=function(t,i){i?this._xyScale*=t:this._xyScale=t;for(var o,r=this._subs.length-1;r>=0;r--)o=this._subs[r],o&&null!==o&&(o instanceof e.Letter?o.setFaceSize(t,i):o.setSubsFaceSize(t,i));var s=this._bold?this._xyScale*n.BOLD_MULT:this._xyScale;return this.placeHolderWidth=this.getFullScalePlaceholderWidth()*s,this.placeHolderHeight=this.getFullScalePlaceholderHeight()*this._xyScale,this},n.prototype.setFaceSize=function(e,t){return t?this._xyScale*=e:this._xyScale=e,this._scaleXY(),this},n.prototype.setBold=function(e){return this._bold=e,this._scaleXY(),this},n.prototype._scaleXY=function(){var e=this._bold?this._xyScale*n.BOLD_MULT:this._xyScale;this.scaling.x=e,this.scaling.y=this._xyScale,this.invalidateLayout()},n.prototype.scaleZ=function(e){for(var t,i=this._subs.length-1;i>=0;i--)t=this._subs[i],t&&null!==t&&(t.scaling.z=e);return this},n.prototype.stretch=function(e,t){return this.stretchVertical=e,this.stretchHorizontal=t,this.invalidateLayout(),this},n.prototype.vertAlign=function(e){return this.verticalAlignment=e,this.invalidateLayout(),this},n.prototype.horizontalAlign=function(e){return this.horizontalAlignment=e,this.invalidateLayout(),this},n.prototype.margin=function(e,t){return this.verticalMargin=e,this.horizontalMargin=t,this.invalidateLayout(),this},n.prototype.disolve=function(e,t){for(var i,n=this._subs.length-1;n>=0;n--)i=this._subs[n],i&&null!==i&&i.disolve(e,t);this!==t&&(this.visibility=this.isBorderVisible()?e:0,this._button&&(this.isPickable=!1))},n.prototype.reAppear=function(){for(var e,t=this._subs.length-1;t>=0;t--)e=this._subs[t],e&&null!==e&&e.reAppear();this.visibility=this.isBorderVisible()?1:0,this._button&&(this.isPickable=!0)},n.prototype.dispose=function(e){this.unregisterBeforeRender(n._beforeRender),t.prototype.dispose.call(this,!1)},n.prototype.freezeWorldMatrixTree=function(){this.freezeWorldMatrix();for(var e,t=this._subs.length-1;t>=0;t--)e=this._subs[t],e&&null!==e&&e.freezeWorldMatrixTree()},n.prototype.unfreezeWorldMatrixTree=function(){t.prototype.unfreezeWorldMatrix.call(this);for(var e,i=this._subs.length-1;i>=0;i--)e=this._subs[i],e&&null!==e&&e.unfreezeWorldMatrixTree()},n})(BABYLON.Mesh);t.BOLD_MULT=1.4,t._NORMALS=[0,0,-1,0,0,-1,.7071,0,-.7071,.7071,0,.7071,.7071,0,-.7071,0,0,1,.7071,0,.7071,-.7071,0,-.7071,-.7071,0,.7071,-.7071,0,.7071,0,0,1,0,0,-1,-.7071,0,-.7071,0,-.7071,-.7071,0,0,-1,0,.7071,.7071,0,0,1,-.7071,0,-.7071,-.5773,.5773,-.5773,-.5773,.5773,.5773,.7071,0,.7071,.5773,.5773,.5773,.5773,.5773,-.5773,-.7071,0,.7071,-.5773,-.5773,.5773,-.5773,-.5773,-.5773,0,-.7071,.7071,.7071,0,-.7071,.5773,-.5773,-.5773,.5773,-.5773,.5773,0,.7071,-.7071,0,.7071,-.7071,0,0,1,0,-.7071,-.7071,-.7071,0,-.7071,0,.7071,.7071,-.7071,0,.7071,.7071,0,-.7071,0,-.7071,.7071,.7071,0,.7071],t._TOP_LEVEL_NORMALS=[0,0,-1,0,0,-1,.7071,0,-.7071,.7071,0,.7071,.7071,0,-.7071,0,0,1,.7071,0,.7071,-.7071,0,-.7071,-.7071,0,.7071,-.7071,0,.7071,0,0,1,0,0,-1,-.7071,0,-.7071,0,-.7071,-.7071,0,0,-1,0,.7071,.7071,0,0,1,-.7071,0,-.7071,-.5773,.5773,-.5773,-.5773,.5773,.5773,.7071,0,.7071,.5773,.5773,.5773,.5773,.5773,-.5773,-.7071,0,.7071,-.5773,-.5773,.5773,-.5773,-.5773,-.5773,0,-.7071,.7071,.7071,0,-.7071,.5773,-.5773,-.5773,.5773,-.5773,.5773,0,.7071,-.7071,0,.7071,-.7071,0,0,1,0,-.7071,-.7071,-.7071,0,-.7071,0,.7071,.7071,-.7071,0,.7071,.7071,0,-.7071,0,-.7071,.7071,.7071,0,.7071,0,0,-1,0,0,-1,0,0,-1,0,0,-1],t._INDICES=[0,1,2,3,4,2,5,3,6,7,8,9,10,9,8,11,7,12,13,1,14,15,5,16,17,18,19,20,21,22,23,24,25,26,24,23,27,28,29,30,18,17,15,30,31,13,25,24,4,0,2,6,3,2,32,5,6,12,7,9,16,10,8,14,11,12,28,27,1,28,1,33,34,25,13,34,13,14,21,5,35,1,13,33,21,20,5,36,19,15,36,15,16,36,17,19,37,20,22,5,15,35,34,23,25,26,32,38,32,39,29,32,26,10,39,27,29,30,0,31,32,29,38,26,23,10,0,37,22,0,30,11,22,21,35,30,17,11,22,35,31,0,22,31,19,18,30,19,30,15,29,28,33,35,15,31,38,29,33,13,26,33,26,38,33,13,24,26],t._TOP_LEVEL_INDICES=[0,1,2,3,4,2,5,3,6,7,8,9,10,9,8,11,7,12,13,1,14,15,5,16,17,18,19,20,21,22,23,24,25,26,24,23,27,28,29,30,18,17,15,30,31,13,25,24,4,0,2,6,3,2,32,5,6,12,7,9,16,10,8,14,11,12,28,27,1,28,1,33,34,25,13,34,13,14,21,5,35,1,13,33,21,20,5,36,19,15,36,15,16,36,17,19,37,20,22,5,15,35,34,23,25,26,32,38,32,39,29,32,26,10,39,27,29,30,0,31,32,29,38,26,23,10,0,37,22,0,30,11,22,21,35,30,17,11,22,35,31,0,22,31,19,18,30,19,30,15,29,28,33,35,15,31,38,29,33,13,26,33,26,38,33,13,24,26,40,41,42,43,40,42],e.BasePanel=t;var i=(function(t){function i(i,n,o){return t.call(this,i,e.DialogSys._scene,null,null,!1,n,!1,o)||this}return __extends(i,t),i.makeList=function(t,n,o,r,s,a){void 0===o&&(o=i.LAYOUT_VERTICAL),void 0===r&&(r=1);var l=new i("list-"+t,i.LAYOUT_VERTICAL,a);l.setBorderVisible(!0);var c=t&&null!=t&&t.replace(" ","").length>0;if(c){var u=new e.Label(t);u.horizontalAlignment=i.ALIGN_HCENTER,s&&null!==s&&u.setLetterMaterial(s),l.addSubPanel(u)}var h=new i("listKids-"+t,o);h.setBorderVisible(c),o===i.LAYOUT_VERTICAL?h.stretchHorizontal=!0:h.stretchVertical=!0;for(var d=0;d<n.length;d++){var _=new e.Label(n[d]);_.setFontSize(r),o===i.LAYOUT_VERTICAL?_.stretchHorizontal=!0:_.stretchVertical=!0,h.addSubPanel(_)}return l.addSubPanel(h),l},i.nestPanels=function(t,n,o,r,s,a){void 0===o&&(o=i.LAYOUT_VERTICAL),void 0===r&&(r=!1);var l=new i("nest-"+t,i.LAYOUT_VERTICAL,a);if(l.setBorderVisible(r),t&&null!=t&&t.replace(" ","").length>0){var c=new e.Label(t);c.horizontalAlignment=i.ALIGN_HCENTER,s&&null!==s&&c.setLetterMaterial(s),l.addSubPanel(c)}var u=new i("nestKids-"+t,o);u.setBorderVisible(r),o===i.LAYOUT_VERTICAL?u.stretchHorizontal=!0:u.stretchVertical=!0;for(var h=0;h<n.length;h++)o===i.LAYOUT_VERTICAL?n[h].stretchHorizontal=!0:n[h].stretchVertical=!0,u.addSubPanel(n[h]);return l.addSubPanel(u),l},i.ExtractMax=function(e){for(var t=e.getVerticesData(BABYLON.VertexBuffer.PositionKind),i=new BABYLON.Vector3((-Number.MAX_VALUE),(-Number.MAX_VALUE),(-Number.MAX_VALUE)),n=e.getTotalVertices(),o=0;o<n;o++){var r=new BABYLON.Vector3(t[3*o],t[3*o+1],t[3*o+2]);i=BABYLON.Vector3.Maximize(r,i)}return i},Object.defineProperty(i,"LAYOUT_HORIZONTAL",{get:function(){return i._LAYOUT_HORIZONTAL},enumerable:!0,configurable:!0}),Object.defineProperty(i,"LAYOUT_VERTICAL",{get:function(){return i._LAYOUT_VERTICAL},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_LEFT",{get:function(){return i._ALIGN_LEFT},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_HCENTER",{get:function(){return i._ALIGN_HCENTER},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_RIGHT",{get:function(){return i._ALIGN_RIGHT},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_TOP",{get:function(){return i._ALIGN_TOP},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_VCENTER",{get:function(){return i._ALIGN_VCENTER},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_BOTTOM",{get:function(){return i._ALIGN_BOTTOM},enumerable:!0,configurable:!0}),i})(t);i._LAYOUT_HORIZONTAL=0,i._LAYOUT_VERTICAL=1,i._ALIGN_LEFT=-3,i._ALIGN_HCENTER=-2,i._ALIGN_RIGHT=-1,i._ALIGN_TOP=1,i._ALIGN_VCENTER=2,i._ALIGN_BOTTOM=3,e.Panel=i})(DIALOG||(DIALOG={}));var DIALOG;!(function(e){var t=(function(t){function i(i,n){var o=t.call(this,null,e.DialogSys._scene)||this;return o.verticalMargin=i,o.horizontalMargin=n,o.setEnabled(!1),o}return __extends(i,t),i.prototype.useGeometryForBorder=function(){return!1},i.prototype.addSubPanel=function(e,t){BABYLON.Tools.Error("spacers can have no sub-panels")},i.prototype.getSubPanel=function(){return null},i.prototype.removeAt=function(e,t){},i.prototype.removeAll=function(e){},i})(e.BasePanel);e.Spacer=t})(DIALOG||(DIALOG={}));var DIALOG;!(function(e){var t=(function(e){function t(i,n,o,r,s){void 0===o&&(o=null);var a=e.call(this,i,n,o,r,s)||this;return a.maxAboveY=t.LETTER_ABOVE,a.minBelowY=-.23,a._consolidated=!1,a.horizontalMargin=0,a.verticalMargin=0,a.visibility=0,a.setBorderVisible(!0),a}return __extends(t,e),t.prototype.useGeometryForBorder=function(){return!1},t.prototype._layout=function(e,t){this._actualAboveOriginX||(this.visibility=1),this._actualAboveOriginX=this._maxAboveOrigin.x,this._actualAboveOriginY=this._maxAboveOrigin.y,this._actualBelowOriginX=this._minBelowOrigin.x,this._actualBelowOriginY=this._minBelowOrigin.y},t.prototype._calcRequiredSize=function(){if(!this._minWorld){var e=BABYLON.Tools.ExtractMinAndMax(this.getVerticesData(BABYLON.VertexBuffer.PositionKind),0,this.getTotalVertices());this._minWorld=e.minimum,this._maxWorld=e.maximum}this._maxAboveOrigin.x=this._maxWorld.x*(this._consolidated?1:this.scaling.x),this._maxAboveOrigin.y=this.maxAboveY*(this._consolidated?this._xyScale:this.scaling.y),this._maxAboveOrigin.z=this._maxWorld.z*this.scaling.z,this._minBelowOrigin.x=this._minWorld.x*(this._consolidated?1:this.scaling.x),this._minBelowOrigin.y=this.minBelowY*(this._consolidated?this._xyScale:this.scaling.y),this._minBelowOrigin.z=this._minWorld.z*this.scaling.z},t.prototype.addSubPanel=function(e,t){BABYLON.Tools.Error("Letters can have no sub-panels")},t.prototype.getSubPanel=function(){return null},t.prototype.removeAt=function(e,t){},t.prototype.removeAll=function(e){},t})(e.BasePanel);t.LETTER_ABOVE=.682,e.Letter=t})(DIALOG||(DIALOG={}));var DigitParts;!(function(e){function t(e,t){var i=p[e];if(!i||null===i)return i||(p[e]=new Array),null;for(var n=i.length-1;n>=0;n--)if(i[n].geometry||t)return i[n];return null}function i(e){var t=p[e];if(t&&null!==t){for(var i=!1,n=t.length-1;n>=0;n--)t[n].geometry?i=!0:t[n]=null;i||(p[e]=null)}}function n(){return[g,f,A]}function o(e,t,i){if(void 0===t&&(t="./"),void 0===i&&(i=!1),!L){t.lastIndexOf("/")+1!==t.length&&(t+="/");var n;n=new BABYLON.StandardMaterial("DigitParts.border",e),n.ambientColor=new BABYLON.Color3(.0574,.8,.0876),n.diffuseColor=new BABYLON.Color3(.0459,.64,.0701),n.specularColor=new BABYLON.Color3(.5,.5,.5),n.emissiveColor=new BABYLON.Color3(0,0,0),n.specularPower=50,n.alpha=1,n.backFaceCulling=!0,n.checkReadyOnlyOnce=!i,n=new BABYLON.StandardMaterial("DigitParts.border.001",e),n.ambientColor=new BABYLON.Color3(.0574,.8,.0876),n.diffuseColor=new BABYLON.Color3(.0459,.64,.0701),n.specularColor=new BABYLON.Color3(.5,.5,.5),n.emissiveColor=new BABYLON.Color3(0,0,0),n.specularPower=50,n.alpha=1,n.backFaceCulling=!0,n.checkReadyOnlyOnce=!i,n=new BABYLON.StandardMaterial("DigitParts.face",e),n.ambientColor=new BABYLON.Color3(.8,.1603,.7314),n.diffuseColor=new BABYLON.Color3(.64,.1283,.5851),n.specularColor=new BABYLON.Color3(.5,.5,.5),n.emissiveColor=new BABYLON.Color3(0,0,0),n.specularPower=50,n.alpha=1,n.backFaceCulling=!0,n.checkReadyOnlyOnce=!i,n=new BABYLON.StandardMaterial("DigitParts.face.001",e),n.ambientColor=new BABYLON.Color3(.8,.1603,.7314),n.diffuseColor=new BABYLON.Color3(.64,.1283,.5851),n.specularColor=new BABYLON.Color3(.5,.5,.5),n.emissiveColor=new BABYLON.Color3(0,0,0),n.specularPower=50,n.alpha=1,n.backFaceCulling=!0,n.checkReadyOnlyOnce=!i,r(e),L=!0}}function r(e){var t;t=new BABYLON.MultiMaterial("DigitParts.Multimaterial#0",e),t.id="DigitParts.Multimaterial#0",t.subMaterials.push(e.getMaterialByID("DigitParts.border")),t.subMaterials.push(e.getMaterialByID("DigitParts.face")),t=new BABYLON.MultiMaterial("DigitParts.Multimaterial#1",e),t.id="DigitParts.Multimaterial#1",t.subMaterials.push(e.getMaterialByID("DigitParts.border.001")),t.subMaterials.push(e.getMaterialByID("DigitParts.face.001"))}function s(e,t,i){var n=new BABYLON.Mesh(t.name+".botLeft",e,t,i),o=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=0,n.position.y=0,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,o||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[.12,.12,0,.12,.46,0,0,.46,0,0,.12,0,0,0,0,.12,.12,0,0,.5196,0,0,.46,0,.1198,.46,0,0,.12,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,n),n.computeWorldMatrix(!0)),n}function a(e,t,i){var n=new BABYLON.Mesh(t.name+".topLeft",e,t,i),o=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=0,n.position.y=.5396,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,o||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[0,.0596,0,.12,.0596,0,.12,.3996,0,0,.3996,0,.12,.3996,0,0,.5196,0,0,0,0,.1198,.0596,0,0,.0596,0,0,.3996,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,n),n.computeWorldMatrix(!0)),n}function l(e,t,i){var n=new BABYLON.Mesh(t.name+".top",e,t,i),o=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=.03,n.position.y=1.0579,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,o||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[.42,0,0,.12,0,0,.12,-.12,0,.42,0,0,.42,-.12,0,.54,0,0,.12,0,0,0,0,0,.12,-.12,0,.42,-.12,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,n),n.computeWorldMatrix(!0)),n}function c(e,t,i){var n=new BABYLON.Mesh(t.name+".topRite",e,t,i),o=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=.6,n.position.y=.5396,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,o||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.12,.3996,0,-.12,.0596,0,0,.0596,0,0,.3996,0,0,.5196,0,-.12,.3996,0,0,0,0,0,.0596,0,-.1198,.0596,0,0,.3996,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,n),n.computeWorldMatrix(!0)),n}function u(e,t,i){var n=new BABYLON.Mesh(t.name+".botRite",e,t,i),o=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=.6,n.position.y=.5196,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,o||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[0,-.0596,0,-.12,-.0596,0,-.12,-.3996,0,0,-.3996,0,-.12,-.3996,0,0,-.5196,0,0,0,0,-.1198,-.0596,0,0,-.0596,0,0,-.3996,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,n),n.computeWorldMatrix(!0)),n}function h(e,t,i){var n=new BABYLON.Mesh(t.name+".bottom",e,t,i),o=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=.03,n.position.y=0,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,o||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[.12,.12,0,.12,0,0,.42,0,0,.12,0,0,.12,.12,0,0,0,0,.42,0,0,.54,0,0,.42,.12,0,.42,.12,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,n),n.computeWorldMatrix(!0)),n}function d(e,t,i){var n=new BABYLON.Mesh(t.name+".dot",e,t,i),o=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=.64,n.position.y=-4e-4,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,o||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[.12,0,0,.12,.12,0,0,.12,0,0,0,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,0,2]),n.subMeshes=[],new BABYLON.SubMesh(0,0,4,0,6,n),n.computeWorldMatrix(!0)),n}function _(e,t,i){var n=new BABYLON.Mesh(t.name+".center",e,t,i),o=i&&null!==i;return n.id=n.name,n.billboardMode=0,n.position.x=.3,n.position.y=.5296,n.position.z=0,n.rotation.x=0,n.rotation.y=0,n.rotation.z=0,n.scaling.x=1,n.scaling.y=1,n.scaling.z=1,n.isVisible=!0,n.setEnabled(!0),n.checkCollisions=!1,n.receiveShadows=!1,n.castShadows=!1,o||(n.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.1451,-.06,0,-.1451,.06,0,-.27,-4e-4,0,-.0289,-.06,0,.1449,-.06,0,-.0289,.06,0,.1449,.06,0,.27,0,0],!1),n.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),n.setIndices([0,1,2,3,4,5,6,4,7,1,0,3,4,6,5,5,1,3]),n.subMeshes=[],new BABYLON.SubMesh(0,0,8,0,18,n),n.computeWorldMatrix(!0)),n}var p=new Array(3),g=1,f=0,A=0,y=(function(){function i(t,i){void 0===i&&(i="./"),this._scene=t,e.defineMaterials(t,i)}return i.prototype.getModuleName=function(){return"DigitParts"},i.prototype.instance=function(e,i){var n,o=null;switch(e){case"Geometry":n=t(0,!0),null===n?(o=new B("Geometry",this._scene),f+=o.getTotalVertices(),p[0].push(o)):(o=new B("Geometry_"+g++,this._scene,null,n),A+=o.getTotalVertices());break;case"Down":n=t(1),null===n?(o=new b("Down",this._scene),f+=o.getTotalVertices(),p[1].push(o)):(o=new b("Down_"+g++,this._scene,null,n),A+=o.getTotalVertices());break;case"Up":n=t(2),null===n?(o=new O("Up",this._scene),f+=o.getTotalVertices(),p[2].push(o)):(o=new O("Up_"+g++,this._scene,null,n),A+=o.getTotalVertices())}if(null!==o){if(i&&n&&n.skeleton){var r=n.skeleton.name+g;o.skeleton=n.skeleton.clone(r,r)}}else BABYLON.Tools.Error("Mesh not found: "+e);return o},i})();e.MeshFactory=y,e.getStats=n;var L=!1;e.defineMaterials=o,e.defineMultiMaterials=r;var B=(function(t){function n(i,n,o,r){void 0===o&&(o="./");var p=t.call(this,i,n,null,r,!0)||this;e.defineMaterials(n,o);var g=r&&null!==r;return p.botLeft=g?s(n,p,r.botLeft):s(n,p),p.topLeft=g?a(n,p,r.topLeft):a(n,p),p.top=g?l(n,p,r.top):l(n,p),p.topRite=g?c(n,p,r.topRite):c(n,p),p.botRite=g?u(n,p,r.botRite):u(n,p),p.bottom=g?h(n,p,r.bottom):h(n,p),p.dot=g?d(n,p,r.dot):d(n,p),p.center=g?_(n,p,r.center):_(n,p),p.id=p.name,p.billboardMode=0,p.position.x=0,p.position.y=0,p.position.z=0,p.rotation.x=0,p.rotation.y=0,p.rotation.z=0,p.scaling.x=1,p.scaling.y=.9523,p.scaling.z=1,p.isVisible=!1,p.setEnabled(!0),p.checkCollisions=!1,p.receiveShadows=!1,p.castShadows=!1,p}return __extends(n,t),n.prototype.dispose=function(e){t.prototype.dispose.call(this,e),i(0)},n})(BABYLON.Mesh);e.Geometry=B;var b=(function(t){function n(i,n,o,r){void 0===o&&(o="./");var s=t.call(this,i,n,null,r,!0)||this;e.defineMaterials(n,o);var a=r&&null!==r;return s.id=s.name,s.billboardMode=0,s.position.x=0,s.position.y=0,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=.9523,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,a||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[0,-.0034,0,.0024,-.0017,0,0,0,0,.8105,-.6441,.02,.8105,.6359,.02,-.0866,-.0021,.02,-.0895,-.0041,.02,-.0895,0,.02,.75,-.5368,0,.75,.5299,0,.0024,-.0017,0],!1),s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),s.setIndices([0,1,2,3,4,5,6,5,7,8,9,10]),s.setMaterialByID("DigitParts.Multimaterial#0"),s.subMeshes=[],new BABYLON.SubMesh(0,0,8,0,9,s),new BABYLON.SubMesh(1,8,3,9,3,s),s.computeWorldMatrix(!0)),s}return __extends(n,t),n.prototype.dispose=function(e){t.prototype.dispose.call(this,e),i(1)},n})(DIALOG.Letter);e.Down=b;var O=(function(t){function n(i,n,o,r){void 0===o&&(o="./");var s=t.call(this,i,n,null,r,!0)||this;e.defineMaterials(n,o);var a=r&&null!==r;return s.id=s.name,s.billboardMode=0,s.position.x=0,s.position.y=0,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=.9523,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,a||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[0,.0034,0,-.0024,.0017,0,0,0,0,-.8105,.6441,.02,-.8105,-.6359,.02,.0866,.0021,.02,.0895,.0041,.02,.0895,0,.02,-.75,.5368,0,-.75,-.5299,0,-.0024,.0017,0],!1),
s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),s.setIndices([0,1,2,3,4,5,6,5,7,8,9,10]),s.setMaterialByID("DigitParts.Multimaterial#1"),s.subMeshes=[],new BABYLON.SubMesh(0,0,8,0,9,s),new BABYLON.SubMesh(1,8,3,9,3,s),s.computeWorldMatrix(!0)),s}return __extends(n,t),n.prototype.dispose=function(e){t.prototype.dispose.call(this,e),i(2)},n})(DIALOG.Letter);e.Up=O})(DigitParts||(DigitParts={}));var CheckBoxFont;!(function(e){function t(e,t){var i=r[e];if(!i||null===i)return i||(r[e]=new Array),null;for(var n=i.length-1;n>=0;n--)if(i[n].geometry||t)return i[n];return null}function i(e){var t=r[e];if(t&&null!==t){for(var i=!1,n=t.length-1;n>=0;n--)t[n].geometry?i=!0:t[n]=null;i||(r[e]=null)}}function n(){return[s,a,l]}function o(e,t){if(void 0===t&&(t="./"),!u){t.lastIndexOf("/")+1!==t.length&&(t+="/");u=!0}}var r=new Array(4),s=1,a=0,l=0,c=(function(){function i(t,i){void 0===i&&(i="./"),this._scene=t,e.defineMaterials(t,i)}return i.prototype.getModuleName=function(){return"CheckBoxFont"},i.prototype.instance=function(e,i){var n,o=null;switch(e){case"unchecked2D":n=t(0),null===n?(o=new h("unchecked2D",this._scene),a+=o.getTotalVertices(),r[0].push(o)):(o=new h("unchecked2D_"+s++,this._scene,null,n),l+=o.getTotalVertices());break;case"checked2D":n=t(1),null===n?(o=new d("checked2D",this._scene),a+=o.getTotalVertices(),r[1].push(o)):(o=new d("checked2D_"+s++,this._scene,null,n),l+=o.getTotalVertices());break;case"checked3D":n=t(2),null===n?(o=new _("checked3D",this._scene),a+=o.getTotalVertices(),r[2].push(o)):(o=new _("checked3D_"+s++,this._scene,null,n),l+=o.getTotalVertices());break;case"unchecked3D":n=t(3),null===n?(o=new p("unchecked3D",this._scene),a+=o.getTotalVertices(),r[3].push(o)):(o=new p("unchecked3D_"+s++,this._scene,null,n),l+=o.getTotalVertices())}if(null!==o){if(i&&n&&n.skeleton){var c=n.skeleton.name+s;o.skeleton=n.skeleton.clone(c,c)}}else BABYLON.Tools.Error("Mesh not found: "+e);return o},i})();e.MeshFactory=c,e.getStats=n;var u=!1;e.defineMaterials=o;var h=(function(t){function n(i,n,o,r){void 0===o&&(o="./");var s=t.call(this,i,n,null,r,!0)||this;e.defineMaterials(n,o);var a=r&&null!==r;return s.id=s.name,s.billboardMode=0,s.position.x=0,s.position.y=0,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=1,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,a||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.6,0,0,-.05,0,0,-.05,.05,0,-.6,0,0,-.6,.65,0,-.65,.65,0,-.6,.6,0,-.05,.6,0,-.05,.65,0,0,0,0,0,.65,0,-.05,.65,0,-.6,.05,0,-.65,0,0,-.6,.65,0,-.05,0,0],!1),s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),s.setIndices([0,1,2,3,4,5,6,7,8,9,10,11,12,0,2,13,3,5,14,6,8,15,9,11]),s.subMeshes=[],new BABYLON.SubMesh(0,0,16,0,24,s),s.computeWorldMatrix(!0)),s}return __extends(n,t),n.prototype.dispose=function(e){t.prototype.dispose.call(this,e),i(0)},n})(DIALOG.Letter);e.unchecked2D=h;var d=(function(t){function n(i,n,o,r){void 0===o&&(o="./");var s=t.call(this,i,n,null,r,!0)||this;e.defineMaterials(n,o);var a=r&&null!==r;return s.id=s.name,s.billboardMode=0,s.position.x=0,s.position.y=0,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=1,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,a||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.1305,.1659,0,-.4841,.5195,0,-.5195,.4841,0,-.4841,.1305,0,-.1305,.4841,0,-.1659,.5195,0,-.6,0,0,-.05,0,0,-.05,.05,0,-.6,0,0,-.6,.65,0,-.65,.65,0,-.6,.6,0,-.05,.6,0,-.05,.65,0,0,0,0,0,.65,0,-.05,.65,0,-.1659,.1305,0,-.5195,.1659,0,-.6,.05,0,-.65,0,0,-.6,.65,0,-.05,0,0],!1),s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),s.setIndices([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,0,2,19,3,5,20,6,8,21,9,11,22,12,14,23,15,17]),s.subMeshes=[],new BABYLON.SubMesh(0,0,24,0,36,s),s.computeWorldMatrix(!0)),s}return __extends(n,t),n.prototype.dispose=function(e){t.prototype.dispose.call(this,e),i(1)},n})(DIALOG.Letter);e.checked2D=d;var _=(function(t){function n(i,n,o,r){void 0===o&&(o="./");var s=t.call(this,i,n,null,r,!0)||this;e.defineMaterials(n,o);var a=r&&null!==r;return s.id=s.name,s.billboardMode=0,s.position.x=0,s.position.y=0,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=1,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,a||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.1305,.1659,0,-.4841,.5195,0,-.5195,.4841,0,-.1659,.1305,0,-.1659,.1305,1,-.4841,.5195,1,-.5195,.4841,1,-.4841,.1305,0,-.1305,.4841,0,-.1659,.5195,0,-.5195,.1659,0,-.5195,.1659,1,-.4841,.1305,1,-.1305,.4841,1,-.1659,.5195,1,-.6,0,0,-.05,0,0,-.05,.05,0,-.6,.05,0,-.6,.05,1,-.6,0,1,-.05,0,1,-.05,.05,1,-.6,0,0,-.6,.65,0,-.65,.65,0,-.6,0,1,-.65,0,0,-.6,.65,1,-.65,.65,1,-.6,.6,0,-.05,.6,0,-.05,.65,0,-.6,.6,1,-.6,.65,0,-.05,.65,1,0,0,0,0,.65,0,-.05,.65,0,0,0,1,-.05,0,0,0,.65,1,-.05,.65,1,-.1305,.1659,1,-.65,0,1,-.6,.65,1,-.05,.6,1,-.05,0,1],!1),s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[.8165,0,-.5773,0,.8165,-.5773,-.8165,0,-.5773,0,-.8165,-.5773,0,-1,0,0,1,0,-1,0,0,0,-.8165,-.5773,.8165,0,-.5773,0,.8165,-.5773,-.8165,0,-.5773,-1,0,0,0,-1,0,1,0,0,0,1,0,-.5773,-.5773,-.5773,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,-.7071,.7071,0,-.7071,-.7071,0,.7071,-.7071,0,.7071,.7071,0,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,.7071,-.7071,0,-.5773,-.5773,-.5773,.7071,.7071,0,-.7071,.7071,0,-.5773,-.5773,-.5773,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.7071,-.7071,0,-.5773,.5773,-.5773,.7071,.7071,0,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,.7071,-.7071,0,-.5773,-.5773,-.5773,.7071,.7071,0,-.7071,.7071,0,1,0,0,-.7071,-.7071,0,-.7071,.7071,0,.7071,-.7071,0,-.7071,-.7071,0],!1),s.setIndices([0,1,2,0,3,4,5,1,0,2,1,5,3,2,6,7,8,9,7,10,11,8,7,12,9,8,13,10,9,14,15,16,17,15,18,19,16,15,20,17,16,21,18,17,22,23,24,25,26,23,27,28,24,23,29,25,24,27,25,29,30,31,32,33,30,34,31,30,33,35,32,31,34,32,35,36,37,38,39,36,40,41,37,36,42,38,37,40,38,42,3,0,2,43,0,4,43,5,0,6,2,5,4,3,6,10,7,9,12,7,11,13,8,12,14,9,13,11,10,14,18,15,17,20,15,19,21,16,20,22,17,21,19,18,22,27,23,25,44,26,27,26,28,23,28,29,24,44,27,29,34,30,32,45,33,34,46,31,33,46,35,31,45,34,35,40,36,38,47,39,40,39,41,36,41,42,37,47,40,42]),s.subMeshes=[],new BABYLON.SubMesh(0,0,48,0,180,s),s.computeWorldMatrix(!0)),s}return __extends(n,t),n.prototype.dispose=function(e){t.prototype.dispose.call(this,e),i(2)},n})(DIALOG.Letter);e.checked3D=_;var p=(function(t){function n(i,n,o,r){void 0===o&&(o="./");var s=t.call(this,i,n,null,r,!0)||this;e.defineMaterials(n,o);var a=r&&null!==r;return s.id=s.name,s.billboardMode=0,s.position.x=0,s.position.y=0,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=1,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,a||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.6,0,0,-.05,0,0,-.05,.05,0,-.6,.05,0,-.6,.05,1,-.6,0,1,-.05,0,1,-.05,.05,1,-.6,0,0,-.6,.65,0,-.65,.65,0,-.6,0,1,-.65,0,0,-.6,.65,1,-.65,.65,1,-.6,.6,0,-.05,.6,0,-.05,.65,0,-.6,.6,1,-.6,.65,0,-.05,.65,1,0,0,0,0,.65,0,-.05,.65,0,0,0,1,-.05,0,0,0,.65,1,-.05,.65,1,-.65,0,1,-.6,.65,1,-.05,.6,1,-.05,0,1],!1),s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[-.5773,-.5773,-.5773,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,-.7071,.7071,0,-.7071,-.7071,0,.7071,-.7071,0,.7071,.7071,0,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,.7071,-.7071,0,-.5773,-.5773,-.5773,.7071,.7071,0,-.7071,.7071,0,-.5773,-.5773,-.5773,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.7071,-.7071,0,-.5773,.5773,-.5773,.7071,.7071,0,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,.7071,-.7071,0,-.5773,-.5773,-.5773,.7071,.7071,0,-.7071,.7071,0,-.7071,-.7071,0,-.7071,.7071,0,.7071,-.7071,0,-.7071,-.7071,0],!1),s.setIndices([0,1,2,0,3,4,1,0,5,2,1,6,3,2,7,8,9,10,11,8,12,13,9,8,14,10,9,12,10,14,15,16,17,18,15,19,16,15,18,20,17,16,19,17,20,21,22,23,24,21,25,26,22,21,27,23,22,25,23,27,3,0,2,5,0,4,6,1,5,7,2,6,4,3,7,12,8,10,28,11,12,11,13,8,13,14,9,28,12,14,19,15,17,29,18,19,30,16,18,30,20,16,29,19,20,25,21,23,31,24,25,24,26,21,26,27,22,31,25,27]),s.subMeshes=[],new BABYLON.SubMesh(0,0,32,0,120,s),s.computeWorldMatrix(!0)),s}return __extends(n,t),n.prototype.dispose=function(e){t.prototype.dispose.call(this,e),i(3)},n})(DIALOG.Letter);e.unchecked3D=p})(CheckBoxFont||(CheckBoxFont={}));var DIALOG;!(function(e){var t=(function(t){function i(e,i){var n=t.call(this,e.name+"_wrapper",e.getScene())||this;return n._inside=e,n._needBorders=i,e.parent=n,n}return __extends(i,t),i.prototype.setMaterial=function(e){this._inside.material=e},i.prototype.useGeometryForBorder=function(){return this._needBorders},i.prototype._layout=function(e,t){this._actualAboveOriginX||(this.visibility=1),this._actualAboveOriginX=this._maxAboveOrigin.x,this._actualAboveOriginY=this._maxAboveOrigin.y,this._actualBelowOriginX=this._minBelowOrigin.x,this._actualBelowOriginY=this._minBelowOrigin.y},i.prototype._calcRequiredSize=function(){if(!this._minWorld){var e=BABYLON.Tools.ExtractMinAndMax(this._inside.getVerticesData(BABYLON.VertexBuffer.PositionKind),0,this._inside.getTotalVertices());this._minWorld=e.minimum,this._maxWorld=e.maximum}this._maxAboveOrigin.x=this._maxWorld.x*this._inside.scaling.x,this._maxAboveOrigin.y=this._maxWorld.y*this._inside.scaling.y,this._maxAboveOrigin.z=this._maxWorld.z*this._inside.scaling.z,this._needBorders&&(this._maxAboveOrigin.x+=this.horizontalMargin,this._maxAboveOrigin.y+=this.verticalMargin),this._minBelowOrigin.x=this._minWorld.x*this._inside.scaling.x,this._minBelowOrigin.y=this._minWorld.y*this._inside.scaling.y,this._minBelowOrigin.z=this._minWorld.z*this._inside.scaling.z,this._needBorders&&(this._minBelowOrigin.x-=this.horizontalMargin,this._minBelowOrigin.y-=this.verticalMargin)},i.prototype.setLayerMask=function(t){for(var i=this._inside.getChildren(),n=i.length-1;n>=0;n--)i[n].layerMask=t,i[n].setEnabled(t!==e.DialogSys.SUSPENDED_DIALOG_LAYER);this._inside.layerMask=t,this._inside.setEnabled(t!==e.DialogSys.SUSPENDED_DIALOG_LAYER),this.layerMask=t,this.setEnabled(t!==e.DialogSys.SUSPENDED_DIALOG_LAYER)},i.prototype.freezeWorldMatrixTree=function(){this.freezeWorldMatrix(),this._inside.freezeWorldMatrix();for(var e=this._inside.getChildren(),t=e.length-1;t>=0;t--)e[t].freezeWorldMatrix()},i.prototype.unfreezeWorldMatrixTree=function(){t.prototype.unfreezeWorldMatrix.call(this);for(var e=this._inside.getChildren(),i=e.length-1;i>=0;i--)e[i].unfreezeWorldMatrix()},i.prototype.addSubPanel=function(e,t){BABYLON.Tools.Error("wrappers can have no sub-panels")},i.prototype.getSubPanel=function(){return null},i.prototype.removeAt=function(e,t){},i.prototype.removeAll=function(e){},i.prototype.setSubsFaceSize=function(e,t){return t?this._xyScale*=e:this._xyScale=e,this._inside.scaling.x=this._xyScale,this._inside.scaling.y=this._xyScale,this.invalidateLayout(),this},i})(e.BasePanel);e.MeshWrapperPanel=t})(DIALOG||(DIALOG={}));var DIALOG;!(function(e){var t=(function(t){function i(n,o,r,s,a){void 0===o&&(o=i.DEFAULT_FONT_MODULE);var l=t.call(this,n,e.DialogSys._scene,null,null,!1,e.Panel.LAYOUT_HORIZONTAL,s)||this;l._prohibitMerging=a,l._merged=!1,l._isTypeface3D=o.indexOf("3D")>-1;for(var c=e.FontFactory.getLetters(n,o,r),u=0;u<c.length;u++)l.addSubPanel(c[u]);return l.setUniformZ(0),s||(l.material=e.DialogSys.ORANGE[1],l.verticalMargin=.02),l}return __extends(i,t),i.prototype.setFontSize=function(e,t){return this.setSubsFaceSize(e,t)},i.prototype.setLetterMaterial=function(t,i){var n,o=t[this._isTypeface3D||e.DialogSys.USE_CULLING_MAT_FOR_2D?0:1],r=this.getSubPanels(),s=-1;i&&(s=this.name.indexOf(i),n=s+i.length-1),s===-1&&(s=0,n=r.length-1);for(var a=s;a<=n;a++)null!==r[a]&&(r[a].material=o);return this},i.prototype.getFullScalePlaceholderWidth=function(){return.15},i.prototype.addSubPanel=function(i,n){return!i||i instanceof e.Letter?void t.prototype.addSubPanel.call(this,i,n):void BABYLON.Tools.Error("Labels can contain only letters")},i.prototype._calcRequiredSize=function(){t.prototype._calcRequiredSize.call(this),!i.NO_MERGING&&!this._prohibitMerging&&this.getSubPanels().length>1&&!this._merged&&(this._mergeMeshes(),t.prototype._calcRequiredSize.call(this))},i.prototype._mergeMeshes=function(){for(var t,i,n,o,r,s=this.getSubPanels(),a=s.length,l=0,c=0,u=0,h=new Array,d=e.DialogSys._scene.getEngine().getCaps().uintIndices?1e6:65536,_=0;_<a;_++)t=s[_],t&&null!==t?(t.parent=null,n=t.getReqdWidth(),l+=t.getTotalVertices(),o&&(t.material!==i||l>d?(h.push(this._bigLetter(i,o)),o=void 0,l=0,c=0):(r=this._extractVertexData(t,c+u*this.placeHolderWidth),o.merge(r))),o||(i=t.material,o=this._extractVertexData(t,u*this.placeHolderWidth)),c+=n+u*this.placeHolderWidth,u=0):u++;h.push(this._bigLetter(i,o)),this.removeAll();for(var p=0;p<h.length;p++)this.addSubPanel(h[p]);this._merged=!0},i.prototype._extractVertexData=function(e,t){var i=BABYLON.VertexData.ExtractFromMesh(e,!0);return e.position.x=t,e.computeWorldMatrix(!0),i.transform(e.worldMatrixFromCache),e.dispose(),i},i.prototype._bigLetter=function(t,i){var n=new e.Letter(this.name+"-merged",e.DialogSys._scene);return i.applyToMesh(n),n.material=t,n._xyScale=this._xyScale,n._consolidated=!0,n._calcRequiredSize(),n},i})(e.BasePanel);t.NO_MERGING=!1,e.Label=t})(DIALOG||(DIALOG={}));var DIALOG;!(function(e){var t=(function(t){function i(n,o,r){void 0===o&&(o=i.ACTION_BUTTON);var s=t.call(this,n,r,null,!0)||this;if(s._button_type=o,s._chngInProgress=!1,s._sysHideButton=!1,s._disolvedState=1,!i.MAT){var a=new BABYLON.MultiMaterial("button",e.DialogSys._scene);a.subMaterials.push(e.DialogSys.GREY[1]),a.subMaterials.push(e.DialogSys.GREY[0]),i.MAT=a,a=new BABYLON.MultiMaterial("button selected",e.DialogSys._scene),a.subMaterials.push(e.DialogSys.ORANGE[1]),a.subMaterials.push(e.DialogSys.GREY[0]),i.SELECTED_MAT=a}s.setBorderVisible(!0),s.borderInsideVert*=1.5,s.horizontalMargin*=1.5,s.verticalMargin*=1.5,s.setFontSize(.65),s.setSelected(!1),s.enableButton(!0);var l=s;return s.registerPickAction((function(){l._panelEnabled&&l.setSelected(!0)})),s._button_type===i.ACTION_BUTTON&&t.prototype.registerAfterRender.call(s,i._delayedStart),s}return __extends(i,t),i._delayedStart=function(e){var t=e;t._chngInProgress?1===t._disolvedState||0===t._disolvedState?(t.setSelected(!1),t._chngInProgress=!1,t._callback&&t._callback(t)):(t._disolvedState=Math.max(t._disolvedState-i.DISOLVE_STEP_RATE,0),t._rootPanel.disolve(t._disolvedState,t)):t.material==i.SELECTED_MAT&&(t._chngInProgress=!0)},i.prototype.setSelected=function(e,t){this._selected=e;var n=0===this._disolvedState;this.material=n?i._DISOLVED_MAT:e?i.SELECTED_MAT:i.MAT,t||this._group&&this._group.reportSelected(this),this._sysHideButton&&(this._chngInProgress||(this._rootPanel=this.getRootPanel(),n?(this._rootPanel.reAppear(),this._disolvedState=1,this.material=i.SELECTED_MAT):this._disolvedState=.99))},i.prototype.enableButton=function(t){this._panelEnabled=t,this.setLetterMaterial(t?e.DialogSys.BLACK:e.DialogSys.LT_GREY)},Object.defineProperty(i.prototype,"radioGroup",{set:function(e){this._button_type===i.RADIO_BUTTON?this._group=e:BABYLON.Tools.Error("Button not radio type")},enumerable:!0,configurable:!0}),i.prototype.hideSystemOnClick=function(t){if(this._sysHideButton=t,t&&!i._DISOLVED_MAT){var n=new BABYLON.StandardMaterial("Clear",e.DialogSys._scene);n.checkReadyOnlyOnce=!0,n.emissiveColor=new BABYLON.Color3(1,1,1),n.alpha=0;var o=new BABYLON.MultiMaterial("disolved_button",e.DialogSys._scene);o.subMaterials.push(n),o.subMaterials.push(n),i._DISOLVED_MAT=o}},i.prototype.isSystemHidden=function(){return 0===this._disolvedState},i.prototype.dispose=function(e){t.prototype.dispose.call(this,!1),this.unregisterAfterRender(i._delayedStart)},i.prototype.reAppearNoCallback=function(){this._rootPanel=this.getRootPanel(),this._rootPanel.reAppear(),this._disolvedState=1,this.material=i.MAT},Object.defineProperty(i,"ACTION_BUTTON",{get:function(){return i._ACTION_BUTTON},enumerable:!0,configurable:!0}),Object.defineProperty(i,"RADIO_BUTTON",{get:function(){return i._RADIO_BUTTON},enumerable:!0,configurable:!0}),i})(e.Label);t.DISOLVE_STEP_RATE=.012,t._ACTION_BUTTON=0,t._RADIO_BUTTON=2,e.Button=t})(DIALOG||(DIALOG={}));var DIALOG;!(function(e){var t=(function(){function t(){}return t.loadStockTypefaces=function(t){"undefined"!=typeof Font3D&&(TOWER_OF_BABEL.MeshFactory.MODULES.push(new Font3D.MeshFactory(t)),e.Label.DEFAULT_FONT_MODULE="Font3D",BABYLON.Tools.Log("Font3D loaded")),"undefined"!=typeof Font2D&&(TOWER_OF_BABEL.MeshFactory.MODULES.push(new Font2D.MeshFactory(t)),e.Label.DEFAULT_FONT_MODULE="Font2D",BABYLON.Tools.Log("Font2D loaded")),"undefined"!=typeof Font3D_EXT&&(TOWER_OF_BABEL.MeshFactory.MODULES.push(new Font3D_EXT.MeshFactory(t)),BABYLON.Tools.Log("Font3D_EXT loaded")),"undefined"!=typeof Font2D_EXT&&(TOWER_OF_BABEL.MeshFactory.MODULES.push(new Font2D_EXT.MeshFactory(t)),BABYLON.Tools.Log("Font2D_EXT loaded"))},t.getLetters=function(t,i,n){for(var o,r=new Array(t.length),s=i.indexOf("3D")>-1,a=t.length-1;a>=0;a--){o=i+(t[a].charCodeAt(0)>128?"_EXT":"");var l=" "!==t[a]?TOWER_OF_BABEL.MeshFactory.instance(o,t[a]):null;l?null!==l&&(l.material=n?n:e.DialogSys.CURRENT_FONT_MAT_ARRAY[s||e.DialogSys.USE_CULLING_MAT_FOR_2D?0:1],s&&(l.scaling.z=e.DialogSys.DEPTH_SCALING_3D)):l=null,r[a]=l}return r},t})();e.FontFactory=t})(DIALOG||(DIALOG={}));var DIALOG;!(function(e){var t=(function(){function t(){}return t.initialize=function(i){if(t._scene=i,!t._camera){t._camera=new BABYLON.FreeCamera("DialogSysCamera",new BABYLON.Vector3(0,0,(-2e3)),i),t._camera.mode=BABYLON.Camera.ORTHOGRAPHIC_CAMERA,t._camera.layerMask=t.ACTIVE_DIALOG_LAYER,i.removeCamera(t._camera);var n=new BABYLON.Vector3((-20),50,(-100));t._light=new BABYLON.PointLight("DialogSysLamp",n,i),t._light.intensity=1,t._light.includeOnlyWithLayerMask=t.ACTIVE_DIALOG_LAYER,window.addEventListener("resize",(function(){e.DialogSys._adjustCameraForPanel()})),BABYLON.Tools.Log("Dialog system ("+t.Version+") initialized")}t.WHITE=t.buildFontMaterials("DialogSys.WHITE",new BABYLON.Color3(1,1,1)),t.BLACK=t.buildFontMaterials("DialogSys.BLACK",new BABYLON.Color3(0,0,0)),t.BLUE=t.buildFontMaterials("DialogSys.BLUE",new BABYLON.Color3(.0815,.162,.8),.8),t.GOLD=t.buildFontMaterials("DialogSys.GOLD",new BABYLON.Color3(1,.8136,.2218)),t.RED=t.buildFontMaterials("DialogSys.RED",new BABYLON.Color3(1,.0046,.0286)),t.GREY=t.buildFontMaterials("DialogSys.GREY",new BABYLON.Color3(.5,.5,.5)),t.LT_GREY=t.buildFontMaterials("DialogSys.LT_GREY",new BABYLON.Color3(.6,.6,.6)),t.ORANGE=t.buildFontMaterials("DialogSys.ORANGE",new BABYLON.Color3(1,.5,0)),t.GREEN=t.buildFontMaterials("DialogSys.GREEN",new BABYLON.Color3(.004,.319,.002)),e.FontFactory.loadStockTypefaces(i),t.CURRENT_FONT_MAT_ARRAY=t.WHITE;for(var o=i.lights.length-1;o>=0;o--)i.lights[o]!==t._light&&(i.lights[o].excludeWithLayerMask=t.ACTIVE_DIALOG_LAYER);this._onNewLightObserver=i.onNewLightAddedObservable.add(t.onNewLight)},t.onNewLight=function(e){e.excludeWithLayerMask=t.ACTIVE_DIALOG_LAYER},t.dispose=function(){t._camera.dispose(),t._light.dispose(),t.WHITE[0].dispose(),t.WHITE[1].dispose(),t.BLACK[0].dispose(),t.BLACK[1].dispose(),t.BLUE[0].dispose(),t.BLUE[1].dispose(),t.GOLD[0].dispose(),t.GOLD[1].dispose(),t.RED[0].dispose(),t.RED[1].dispose(),t.GREY[0].dispose(),t.GREY[1].dispose(),t.LT_GREY[0].dispose(),t.LT_GREY[1].dispose(),t.ORANGE[0].dispose(),t.ORANGE[1].dispose(),t.GREEN[0].dispose(),t.GREEN[1].dispose(),t._scene.onNewLightAddedObservable.remove(t._onNewLightObserver),t._scene=null},t.buildFontMaterials=function(e,i,n,o){void 0===n&&(n=1),void 0===o&&(o=1);var r=new Array(2),s=new BABYLON.StandardMaterial(e+"-3D",t._scene);return s.checkReadyOnlyOnce=!0,s.ambientColor=i,s.diffuseColor=1===n?i:new BABYLON.Color3(i.r*n,i.g*n,i.b*n),s.specularColor=new BABYLON.Color3(.5,.5,.5),s.specularPower=80,s.alpha=o,r[0]=s,s=s.clone(e+"-2D"),s.backFaceCulling=!1,r[1]=s,r},t.pushPanel=function(e){e._topLevel||BABYLON.Tools.Error("Only top Level panels can be used in displayPanel()"),0===e.getReqdWidth()&&e.layout(),t._dialogStack.length>0?t._dialogStack[t._dialogStack.length-1].setLayerMask(t.SUSPENDED_DIALOG_LAYER):(t._scene.addCamera(t._camera),0===t._scene.activeCameras.length&&t._scene.activeCameras.push(t._scene.activeCamera),t._scene.activeCameras.push(t._camera)),t._scene.activeCameras[0].layerMask=t.DEFAULT_LAYERMASK,t._dialogStack.push(e),t._adjustCameraForPanel(),e.setLayerMask(t.ACTIVE_DIALOG_LAYER)},t.popPanel=function(e){var i=t._dialogStack.pop(),n=i.modalReturnedValue;if(e?i.setLayerMask(t.DEFAULT_LAYERMASK):i.dispose(),t._dialogStack.length>0){var o=t._dialogStack[t._dialogStack.length-1];o.setLayerMask(t.ACTIVE_DIALOG_LAYER),t._adjustCameraForPanel(),o.modalReturnedValue=n,o.modalReturnCallBack&&o.modalReturnCallBack()}else t._scene.activeCameras.pop(),t._scene.removeCamera(t._camera);return n},t._adjustCameraForPanel=function(){if(t._dialogStack&&0!==t._dialogStack.length){var i=t._dialogStack[t._dialogStack.length-1];if(i.fitToWindow){var n=t._getScalingToWindow(i._originalReqdWidth,i._originalReqdHeight),o=i._originalReqdWidth*(n.y<n.x?n.x/n.y:1),r=i._originalReqdHeight*(n.y>n.x?n.y/n.x:1);i._assignRequirements(o,r),i._layout(i.getReqdWidth(),i.getReqdHeight()),i.freezeWorldMatrix()}var s=i.getReqdWidth()/2,a=i.getReqdHeight()/2;t._camera.orthoTop=a,t._camera.orthoBottom=-a,t._camera.orthoLeft=-s,t._camera.orthoRight=s,t._camera.getProjectionMatrix();var l,n=t._getScalingToWindow(s,a),o=window.innerWidth*(n.y<n.x?n.y/n.x:1),r=window.innerHeight*(n.y>n.x?n.x/n.y:1),c=i.maxViewportWidth*o/window.innerWidth,u=i.maxViewportHeight*r/window.innerHeight;switch(i.fitToWindow?e.Panel.ALIGN_HCENTER:i.horizontalAlignment){case e.Panel.ALIGN_LEFT:l=0;break;case e.Panel.ALIGN_HCENTER:l=(1-c)/2;break;case e.Panel.ALIGN_RIGHT:l=1-c}var h;switch(i.fitToWindow?e.Panel.ALIGN_VCENTER:i.verticalAlignment){case e.Panel.ALIGN_TOP:h=1-u;break;case e.Panel.ALIGN_VCENTER:h=(1-u)/2;break;case e.Panel.ALIGN_BOTTOM:h=0}t._camera.viewport=new BABYLON.Viewport(l,h,c,u)}},t._getScalingToWindow=function(e,t){return new BABYLON.Vector2(window.innerWidth/e,window.innerHeight/t)},Object.defineProperty(t,"Version",{get:function(){return"1.1.2"},enumerable:!0,configurable:!0}),t})();t.ACTIVE_DIALOG_LAYER=268435456,t.SUSPENDED_DIALOG_LAYER=0,t.DEFAULT_LAYERMASK=268435455,t._dialogStack=new Array,t.USE_CULLING_MAT_FOR_2D=!0,t.DEPTH_SCALING_3D=.05,e.DialogSys=t})(DIALOG||(DIALOG={}));var DIALOG;!(function(e){var t=(function(t){function i(n,o,r){void 0===o&&(o=e.Label.DEFAULT_FONT_MODULE);var s=t.call(this,n,o,null,!0,r)||this;i.factory||(i.factory=new CheckBoxFont.MeshFactory(e.DialogSys._scene));var a=s;return s.registerPickAction((function(){a._panelEnabled&&a.setSelected(!this._selected)})),s}return __extends(i,t),i.prototype._assignCheckMesh=function(){var t,n=this.getSubPanels();null!==n[0]&&(t=n[0].position,n[0].dispose()),this._isTypeface3D?(n[0]=i.factory.instance(this._selected?"checked3D":"unchecked3D"),n[0].scaling.z=e.DialogSys.DEPTH_SCALING_3D):n[0]=i.factory.instance(this._selected?"checked2D":"unchecked2D");for(var o=n.length-1;null===n[o];)o--;n[0].material=n[o].material,n[0].scaling.x=n[o]._xyScale,n[0].scaling.y=n[o]._xyScale,n[0].layerMask=n[o].layerMask,n[0].parent=this,n[0]._calcRequiredSize(),n[0].visibility=1,t&&(n[0].position=t)},i.prototype.setSelected=function(e){this._selected=e,this._assignCheckMesh(),this._callback&&this._callback(this)},i.prototype.enableButton=function(t){this._panelEnabled=t,this.setLetterMaterial(t?e.DialogSys.CURRENT_FONT_MAT_ARRAY:e.DialogSys.LT_GREY)},i.prototype._calcRequiredSize=function(){t.prototype._calcRequiredSize.call(this);var e=this.getSubPanels();e[0]instanceof CheckBoxFont.unchecked2D||e[0]instanceof CheckBoxFont.checked2D||e[0]instanceof CheckBoxFont.unchecked3D||e[0]instanceof CheckBoxFont.checked3D||(this.addSubPanel(null,0),this.addSubPanel(null,0),this._assignCheckMesh(),t.prototype._calcRequiredSize.call(this))},i})(e.Label);e.CheckBox=t})(DIALOG||(DIALOG={}));var DIALOG;!(function(e){var t,i=(function(i){function o(){var r=this;if(!t){t=new DigitParts.MeshFactory(e.DialogSys._scene);var s=t.instance("Geometry"),a=e.Panel.ExtractMax(s.dot).x+s.dot.position.x+.05,l=e.Panel.ExtractMax(s.top).y+s.top.position.y;o._maxWorld=new BABYLON.Vector3(a,l,0),s.dispose(!1)}return r=i.call(this,t.instance("Geometry"))||this,r.setMaterial(n.MAT),r._minWorld=BABYLON.Vector3.Zero(),r._maxWorld=o._maxWorld,r._maxVisibility=1,r.setDigit("0",!1),r}return __extends(o,i),o.prototype.setDigit=function(e,t,i){var n=this._inside;if("E0123456789-".indexOf(e)===-1||1!==e.length)return void BABYLON.Tools.Error(e+" is not a valid setting for Digit");this._val=e,this._show0=t,this._showDot=i;var o=t&&"0".indexOf(e)!==-1;n.botLeft.visibility="E268".indexOf(e)!==-1||o?this._maxVisibility:0,n.topLeft.visibility="E45689".indexOf(e)!==-1||o?this._maxVisibility:0,n.top.visibility="E2356789".indexOf(e)!==-1||o?this._maxVisibility:0,n.bottom.visibility="E235689".indexOf(e)!==-1||o?this._maxVisibility:0,n.botRite.visibility="13456789".indexOf(e)!==-1||o?this._maxVisibility:0,n.topRite.visibility="1234789".indexOf(e)!==-1||o?this._maxVisibility:0,n.center.visibility="E2345689-".indexOf(e)!==-1?this._maxVisibility:0,n.dot.visibility=i?this._maxVisibility:0},o.prototype.setMaterial=function(e){var t=this._inside;t.botLeft.material=e,t.topLeft.material=e,t.top.material=e,t.bottom.material=e,t.botRite.material=e,t.topRite.material=e,t.center.material=e,t.dot.material=e},o.prototype.disolve=function(e,t){this._maxVisibility=e,this.setDigit(this._val,this._show0,this._showDot)},o.prototype.reAppear=function(){this._maxVisibility=1,this.setDigit(this._val,this._show0,this._showDot)},o.prototype.dispose=function(e){i.prototype.dispose.call(this)},o})(e.MeshWrapperPanel),n=(function(t){function n(o,r,s,a){var l=t.call(this,o,e.DialogSys._scene)||this;l._nDigits=r,l._alwaysDot=s,l._fixed=a,l.name=o,n._initMaterial(),l.material=n.MAT;for(var c=0;c<r;c++)l.addSubPanel(new i);return l.value=0,l}return __extends(n,t),Object.defineProperty(n.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e;var t=this._fixed?e.toFixed(this._fixed):e.toString(),i=t.length;t.indexOf(".")!==-1?i--:this._alwaysDot&&(t+=".");var n=this.getSubPanels();if(i>this._nDigits){n[0].setDigit("E");for(var o=1;o<this._nDigits;o++)n[o].setDigit("0",!1)}else{for(var r=this._nDigits-i,o=0;o<r;o++)n[o].setDigit("0",!1);for(var s=0,o=r;o<this._nDigits;o++){var a="."===t.charAt(s+1);n[o].setDigit(t.charAt(s++),!0,a),a&&s++}}},enumerable:!0,configurable:!0}),n._initMaterial=function(){n.MAT||(n.MAT=e.DialogSys.BLACK[e.DialogSys.USE_CULLING_MAT_FOR_2D?0:1])},n})(e.BasePanel);e.LCD=n;var o=(function(i){function o(t,r,s,a,l,c,u){void 0===c&&(c=1);var h=i.call(this,t,e.DialogSys._scene)||this;if(h.minValue=s,h.maxValue=a,h.increment=c,!o.MAT){n._initMaterial();var d=new BABYLON.MultiMaterial("button",e.DialogSys._scene);d.subMaterials.push(n.MAT),d.subMaterials.push(n.MAT),o.MAT=d,d=new BABYLON.MultiMaterial("button selected",e.DialogSys._scene),d.subMaterials.push(n.MAT),d.subMaterials.push(e.DialogSys.ORANGE[0]),o.SELECTED_MAT=d}if(c<=0)return BABYLON.Tools.Error("increment must positive"),h;if(h.minValue+c>h.maxValue)return BABYLON.Tools.Error("min value + increment must be <= max value"),h;if(l<h.minValue||l>h.maxValue)return BABYLON.Tools.Error("initialValue not within min & max values"),h;var _=Math.floor(h.minValue)!==h.minValue||Math.floor(h.maxValue)!==h.maxValue||Math.floor(h.increment)!==h.increment;if(!_&&Math.floor(l)!==l)return BABYLON.Tools.Error("initialValue must be integer, since minValue, maxValue, & increment are"),h;if(h._display=new n(name+"-lcd",r,_,u),h._display.setBorderVisible(!0),h._display.verticalAlignment=e.Panel.ALIGN_VCENTER,h.value=l,h._display._calcRequiredSize(),t&&null!=t&&t.replace(" ","").length>0){var p=new e.Label(t);p.verticalAlignment=e.Panel.ALIGN_BOTTOM,h.addSubPanel(p)}return h.addSubPanel(h._downButton=h._getButton("Down",h)),h.addSubPanel(h._display),h.addSubPanel(h._upButton=h._getButton("Up",h)),h}return __extends(o,i),o.prototype.dispose=function(e){i.prototype.dispose.call(this,!1),this.unregisterAfterRender(o._normalMaterials)},o.prototype._getButton=function(i,n){var r=t.instance(i),s=e.Panel.ExtractMax(r).y;r.verticalAlignment=e.Panel.ALIGN_VCENTER,r.maxAboveY=s,r.minBelowY=-s,r.material=o.MAT,r.setButton(!0),r.registerAfterRender(o._normalMaterials);var a=this;return r.registerPickAction((function(){r._panelEnabled&&(r.material=o.SELECTED_MAT,"Down"===i?a._decrement():a._increment(),n._callback&&n._callback(n))})),r},o._normalMaterials=function(e){var t=e;t._chngInProgress?(t._chngInProgress=!1,t.material=o.MAT):t.material!==o.MAT&&(t._chngInProgress=!0)},o.prototype._increment=function(){this.value+this.increment<=this.maxValue&&(this.value+=this.increment)},o.prototype._decrement=function(){this.value-this.increment>=this.minValue&&(this.value-=this.increment)},Object.defineProperty(o.prototype,"value",{get:function(){return this._display.value},set:function(e){this._display.value=e},enumerable:!0,configurable:!0}),o})(e.BasePanel);e.NumberScroller=o})(DIALOG||(DIALOG={}));var DIALOG;!(function(e){var t=(function(t){function i(i,n,o,r){void 0===o&&(o=e.Panel.LAYOUT_VERTICAL);var s=t.call(this,i,e.DialogSys._scene,null,null,!1,e.Panel.LAYOUT_VERTICAL,r)||this;if(s._callbacks=new Array,s.setBorderVisible(!0),i&&null!=i&&i.replace(" ","").length>0){var a=new e.Label(i);a.horizontalAlignment=e.Panel.ALIGN_HCENTER,t.prototype.addSubPanel.call(s,a)}s._menu=new e.BasePanel("menu-"+i,e.DialogSys._scene,null,null,(!1),o);for(var l=0;l<n.length;l++){var c=new e.Button(n[l],e.Button.RADIO_BUTTON);c.stretchHorizontal=o===e.Panel.LAYOUT_VERTICAL,c.radioGroup=s,s._menu.addSubPanel(c)}return t.prototype.addSubPanel.call(s,s._menu),s}return __extends(i,t),i.prototype.assignMenuCallback=function(e,t){this._callbacks[e]=t},i.prototype.reportSelected=function(e){for(var t=this._menu.getSubPanels(),i=0;i<t.length;i++){var n=t[i];n!=e?n.setSelected(!1,!0):(this._selectedIndex=i,this._callbacks[i]&&null!==this._callbacks[i]&&this._callbacks[i](n))}},Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){this._menu.getSubPanels()[e].setSelected(!0)},enumerable:!0,configurable:!0}),i.prototype.addSubPanel=function(t,i){return!t||t instanceof e.Button?(this._menu.addSubPanel(t,i),void(i?this._callbacks.splice(i,0,null):this._callbacks.push(null))):void BABYLON.Tools.Error("Labels can contain only Buttons")},i.prototype.removeAt=function(e){t.prototype.removeAt.call(this,e),this._callbacks.splice(e,1)},i.prototype.removeAll=function(){t.prototype.removeAll.call(this),this._callbacks=new Array},i})(e.BasePanel);e.Menu=t})(DIALOG||(DIALOG={})),("undefined"!=typeof window&&window.module||"undefined"!=typeof module)&&"undefined"!=typeof module.exports&&(module.exports=DIALOG);